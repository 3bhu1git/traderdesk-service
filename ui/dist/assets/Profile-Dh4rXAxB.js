import{c as S,n as T,f as E,m as C,r as m,j as e,X as A,U,o as N}from"./index-CJAOEYsQ.js";import{P as y}from"./pen-square-DaSocAEw.js";import{C as I}from"./clock-99ryEmKF.js";import{P as D}from"./phone-Buo3OCKm.js";const M=S("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),G=S("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),w=T();class L{static getAuthToken(){return localStorage.getItem("traderdesk_auth_token")}static getAuthHeaders(){const i={"Content-Type":"application/json"},l=this.getAuthToken();return l&&(i.Authorization=`Bearer ${l}`),i}static async updateProfile(i){try{console.log("[UserService] Updating profile:",i);const n=await(await fetch(`${w}/api/user/profile`,{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(i)})).json();return console.log("[UserService] Update profile response:",n),n}catch(l){return console.error("[UserService] Update profile network error:",l),{success:!1,message:"Network error. Please check your connection and try again."}}}static async getProfile(){try{console.log("[UserService] Getting profile");const l=await(await fetch(`${w}/api/user/profile`,{method:"GET",headers:this.getAuthHeaders()})).json();return console.log("[UserService] Get profile response:",l),l}catch(i){return console.error("[UserService] Get profile network error:",i),{success:!1,message:"Network error. Please check your connection and try again."}}}}const $=()=>{var j,v,b;const{user:s,logout:i,updateUser:l}=E(),{currentPlan:n}=C(),[o,u]=m.useState(!(s!=null&&s.isProfileComplete)),[p,f]=m.useState(!1),[x,d]=m.useState(""),[t,c]=m.useState({name:"",email:"",tradingExperience:"Intermediate",tradingStyle:"Swing Trading"});m.useEffect(()=>{var r,a;if(s){const g=(r=s.name)==null?void 0:r.startsWith("User "),k=(a=s.email)==null?void 0:a.includes("@traderdesk.ai");c({name:g?"":s.name||"",email:k?"":s.email||"",tradingExperience:s.tradingExperience||"Intermediate",tradingStyle:s.tradingStyle||"Swing Trading"})}},[s]);const P=async()=>{var r;try{if(f(!0),d(""),!t.name||!t.email||!t.tradingExperience||!t.tradingStyle){d("All fields are required");return}const a=await L.updateProfile(t);if(a.success){if(d("Profile updated successfully!"),u(!1),(r=a.data)!=null&&r.user){const g={...s,name:a.data.user.name,email:a.data.user.email,tradingExperience:a.data.user.tradingExperience,tradingStyle:a.data.user.tradingStyle,isProfileComplete:a.data.user.isProfileComplete};l(g),a.data.user.isProfileComplete&&!(s!=null&&s.isProfileComplete)&&d("Profile completed! You can now access all features.")}setTimeout(()=>d(""),3e3)}else d(a.message||"Failed to update profile")}catch(a){console.error("Profile update error:",a),d("Failed to update profile. Please try again.")}finally{f(!1)}},h={deviceId:((j=s==null?void 0:s.deviceId)==null?void 0:j.slice(-8))||"Unknown",sessionId:((v=s==null?void 0:s.sessionId)==null?void 0:v.slice(-8))||"Unknown",loginTime:new Date().toLocaleString(),expiryTime:s!=null&&s.sessionExpiry?new Date(s.sessionExpiry).toLocaleString():"Unknown",remainingTime:s!=null&&s.sessionExpiry?Math.max(0,Math.floor((new Date(s.sessionExpiry).getTime()-new Date().getTime())/1e3/60/60)):0};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[!(s!=null&&s.isProfileComplete)&&e.jsx("div",{className:"bg-gradient-to-r from-orange-900/20 to-orange-800/20 border border-orange-700/30 rounded-sm p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"w-5 h-5 text-orange-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-orange-300",children:"Complete Your Profile"}),e.jsx("p",{className:"text-sm text-orange-300/80 mt-1",children:"Please complete your profile information to access all trading features."})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-200",children:"Profile Settings"}),e.jsx("p",{className:"text-slate-400 mt-1",children:s!=null&&s.isProfileComplete?"Manage your account and preferences":"Complete your profile to access all features"})]}),(s==null?void 0:s.isProfileComplete)&&e.jsxs("button",{onClick:()=>u(!o),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-sm hover:from-green-700 hover:to-green-600 transition-all duration-200 shadow-lg hover:shadow-green-500/25",children:[o?e.jsx(A,{className:"w-4 h-4"}):e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:o?"Cancel":"Edit Profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"professional-card p-6 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx(U,{className:"w-5 h-5 text-green-400"}),e.jsx("h2",{className:"text-xl font-semibold text-slate-200",children:"Profile Information"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-600 to-green-500 rounded-2xl flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-white",children:((b=s==null?void 0:s.phone)==null?void 0:b.slice(-2))||"TD"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-200",children:t.name}),e.jsx("p",{className:"text-sm text-slate-400",children:s==null?void 0:s.phone})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",value:t.name,onChange:r=>c({...t,name:r.target.value}),disabled:!o,placeholder:"Enter your full name",className:"w-full px-4 py-3 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-200 focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500/50 disabled:bg-slate-800/30 disabled:cursor-not-allowed placeholder-slate-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:t.email,onChange:r=>c({...t,email:r.target.value}),disabled:!o,placeholder:"Enter your email address",className:"w-full px-4 py-3 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-200 focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500/50 disabled:bg-slate-800/30 disabled:cursor-not-allowed placeholder-slate-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Trading Experience"}),e.jsxs("select",{value:t.tradingExperience,onChange:r=>c({...t,tradingExperience:r.target.value}),disabled:!o,className:"w-full px-4 py-3 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-200 focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500/50 disabled:bg-slate-800/30 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"Beginner",children:"Beginner"}),e.jsx("option",{value:"Intermediate",children:"Intermediate"}),e.jsx("option",{value:"Advanced",children:"Advanced"}),e.jsx("option",{value:"Professional",children:"Professional"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Trading Style"}),e.jsxs("select",{value:t.tradingStyle,onChange:r=>c({...t,tradingStyle:r.target.value}),disabled:!o,className:"w-full px-4 py-3 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-200 focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500/50 disabled:bg-slate-800/30 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"Day Trading",children:"Day Trading"}),e.jsx("option",{value:"Swing Trading",children:"Swing Trading"}),e.jsx("option",{value:"Position Trading",children:"Position Trading"}),e.jsx("option",{value:"Scalping",children:"Scalping"})]})]})]}),x&&e.jsx("div",{className:`p-3 rounded-sm border text-sm ${x.includes("success")||x.includes("completed")?"bg-green-900/20 border-green-700/30 text-green-300":"bg-red-900/20 border-red-700/30 text-red-300"}`,children:x}),o&&e.jsxs("button",{onClick:P,disabled:p,className:"w-full bg-gradient-to-r from-green-600 to-green-500 text-white py-3 rounded-sm font-semibold hover:from-green-700 hover:to-green-600 transition-all duration-200 flex items-center justify-center space-x-2 shadow-lg hover:shadow-green-500/25 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{children:p?"Saving...":"Save Changes"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"professional-card p-6 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx(N,{className:"w-5 h-5 text-green-400"}),e.jsx("h2",{className:"text-xl font-semibold text-slate-200",children:"Session Security"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(G,{className:"w-5 h-5 text-green-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-200",children:"Current Device"}),e.jsxs("div",{className:"text-sm text-slate-400",children:["ID: ...",h.deviceId]})]})]}),e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{className:"w-5 h-5 text-orange-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-200",children:"Session Time"}),e.jsxs("div",{className:"text-sm text-slate-400",children:[h.remainingTime,"h remaining"]})]})]}),e.jsx("div",{className:"text-sm text-orange-400 font-medium",children:h.remainingTime<2?"Expiring Soon":"Active"})]}),e.jsx("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-sm p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(N,{className:"w-4 h-4 text-yellow-400 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-slate-200 mb-1",children:"Security Notice"}),e.jsxs("ul",{className:"text-slate-400 space-y-1",children:[e.jsx("li",{children:"• Single device access for security"}),e.jsx("li",{children:"• Session expires after 12 hours"}),e.jsx("li",{children:"• Automatic logout on new device login"})]})]})]})})]})]}),e.jsxs("div",{className:"professional-card p-6 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx(D,{className:"w-5 h-5 text-green-400"}),e.jsx("h2",{className:"text-xl font-semibold text-slate-200",children:"Subscription Status"})]}),e.jsxs("div",{className:"space-y-4",children:[n&&e.jsxs("div",{className:"bg-gradient-to-r from-green-900/20 to-green-800/20 border border-green-700/30 rounded-sm p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"font-semibold text-green-300",children:[n.name," Plan"]}),e.jsx("span",{className:"px-3 py-1 bg-green-900/30 text-green-400 rounded-sm text-sm font-medium border border-green-700/50",children:"Active"})]}),e.jsxs("div",{className:"text-sm text-green-300 space-y-1",children:[e.jsxs("div",{children:["Price: ₹",n.price,"/",n.duration.replace("ly","")]}),e.jsx("div",{children:"Next billing: 30 days"}),e.jsxs("div",{children:["Features: ",n.features.length," included"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400",children:"Login Method"}),e.jsx("div",{className:"font-medium text-slate-200",children:"Phone OTP"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400",children:"Account Type"}),e.jsx("div",{className:"font-medium text-slate-200",children:"Premium"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400",children:"Member Since"}),e.jsx("div",{className:"font-medium text-slate-200",children:"Jan 2024"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400",children:"Status"}),e.jsx("div",{className:"font-medium text-green-400",children:"Verified"})]})]})]})]})]})]}),e.jsx("div",{className:"professional-card p-6 bg-gradient-to-r from-red-900/20 to-red-800/20 border border-red-700/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-200 mb-1",children:"Account Actions"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Manage your account security"})]}),e.jsx("button",{onClick:i,className:"px-6 py-3 bg-gradient-to-r from-red-600 to-red-500 text-white rounded-sm font-semibold hover:from-red-700 hover:to-red-600 transition-all duration-200 shadow-lg hover:shadow-red-500/25",children:"Logout"})]})})]})};export{$ as default};
