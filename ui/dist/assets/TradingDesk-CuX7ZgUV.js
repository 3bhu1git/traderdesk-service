import{c as z,r as i,j as e,X as G,T as U,a as L,U as W,b as Q,Z as X,A as Z,d as ee,e as V,L as te,f as se}from"./index-CJAOEYsQ.js";import{P as ae}from"./PaidUserGuard-BF9fc_-7.js";import{S as re}from"./search-D7lMVmtB.js";import{L as Y}from"./loader-9s8UsnVS.js";import{C as K}from"./clock-99ryEmKF.js";import{S as _}from"./send-cxHe-UFn.js";import{D as E,L as ne}from"./dhanApiService-CQPu0InZ.js";import{E as oe}from"./ErrorBoundary-BV10QnMf.js";import{C as ie}from"./check-DGCGWNbd.js";import{R as le}from"./refresh-cw-Uhijyyid.js";import{E as ce}from"./eye-CzX2Ss8Z.js";const R=z("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),de=z("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),me=({onSymbolSelect:h,selectedSymbol:x})=>{const[g,u]=i.useState(""),[p,f]=i.useState([]),[v,$]=i.useState(!1),[M,N]=i.useState(!1),[b,S]=i.useState([]),[P]=i.useState(["NIFTY","BANKNIFTY","RELIANCE","TCS","HDFCBANK","INFY","ADANIPORTS","JSWSTEEL","TATAMOTORS","ICICIBANK","SBIN","AXISBANK"]),T=i.useRef(null),k=i.useRef(null);i.useEffect(()=>{const t=localStorage.getItem("recentSearches");t&&S(JSON.parse(t))},[]);const I=t=>{const s=[t,...b.filter(a=>a!==t).slice(0,4)];S(s),localStorage.setItem("recentSearches",JSON.stringify(s))};i.useEffect(()=>{if(!g||g.length<2){f([]);return}const t=setTimeout(async()=>{$(!0);try{f([]),N(!0)}catch{f([]),N(!0)}finally{$(!1)}},300);return()=>clearTimeout(t)},[g]),i.useEffect(()=>{const t=s=>{T.current&&!T.current.contains(s.target)&&N(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]);const y=t=>{h(t),u(""),N(!1),I(t)},F=()=>{u(""),f([]),k.current&&k.current.focus()};return e.jsxs("div",{className:"professional-card p-4 border border-slate-700/50",ref:T,children:[e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{ref:k,type:"text",placeholder:"Search symbols (e.g., NIFTY, RELIANCE, TCS)...",value:g,onChange:t=>u(t.target.value),onFocus:()=>N(!0),className:"w-full pl-10 pr-10 py-3 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-200 placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-green-500/50 focus:border-green-500/50 backdrop-blur-sm text-base font-mono"}),g&&e.jsx("button",{onClick:F,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-200",children:e.jsx(G,{className:"w-5 h-5"})}),M&&e.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 bg-slate-900/95 backdrop-blur-xl rounded-sm shadow-xl border border-slate-700/50 z-20",children:v?e.jsx("div",{className:"p-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(Y,{className:"w-5 h-5 text-green-400 animate-spin"}),e.jsx("p",{className:"text-slate-400 font-mono",children:"Searching..."})]})}):e.jsx("div",{className:"max-h-80 overflow-y-auto professional-scroll",children:g.length<2?e.jsxs(e.Fragment,{children:[b.length>0&&e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 px-2 py-1",children:[e.jsx(K,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"text-xs text-slate-500 font-mono",children:"RECENT SEARCHES"})]}),e.jsx("div",{className:"mt-1",children:b.map(t=>e.jsxs("div",{onClick:()=>y(t),className:"px-4 py-2 hover:bg-slate-800/50 cursor-pointer flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-200 font-mono",children:t}),e.jsx("span",{className:"text-xs text-green-400 font-mono",children:"NSE"})]},t))})]}),e.jsxs("div",{className:"p-2 border-t border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center space-x-2 px-2 py-1",children:[e.jsx(U,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"text-xs text-slate-500 font-mono",children:"POPULAR SYMBOLS"})]}),e.jsx("div",{className:"mt-1 grid grid-cols-2 md:grid-cols-3 gap-1",children:P.map(t=>e.jsxs("div",{onClick:()=>y(t),className:`px-3 py-2 rounded-sm cursor-pointer flex items-center space-x-2 ${x===t?"bg-green-600/30 text-green-300 border border-green-600/50":"hover:bg-slate-800/50 text-slate-300"}`,children:[e.jsx(L,{className:"w-3 h-3 text-slate-400"}),e.jsx("span",{className:"font-mono",children:t})]},t))})]})]}):p.length>0?e.jsx("div",{children:p.map(t=>e.jsxs("div",{onClick:()=>y(t.symbol),className:"px-4 py-3 hover:bg-slate-800/50 cursor-pointer flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-200 font-mono",children:t.symbol}),e.jsx("p",{className:"text-xs text-slate-400 font-mono",children:t.name})]}),e.jsx("span",{className:"text-xs text-green-400 font-mono",children:t.exchange||"NSE"})]},t.symbol))}):e.jsxs("div",{className:"p-4 text-center text-slate-400 font-mono",children:['No results found for "',g,'"']})})})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:["NIFTY","BANKNIFTY","RELIANCE","TCS","HDFCBANK"].map(t=>e.jsx("button",{onClick:()=>y(t),className:`px-3 py-1.5 text-sm font-mono rounded-sm transition-all duration-200 ${x===t?"bg-green-600/30 text-green-300 border border-green-600/50":"bg-slate-800/60 text-slate-300 border border-slate-600/50 hover:bg-slate-700/60 hover:text-green-300"}`,children:t},t))})]})},he=({onSymbolSelect:h})=>{const[x,g]=i.useState([{id:"1",content:"Hello! I'm your AI trading assistant. Ask me about any stock, index, or trading strategy, and I'll provide real-time analysis and insights.",sender:"ai",timestamp:new Date}]),[u,p]=i.useState(""),[f,v]=i.useState(!1),$=i.useRef(null);i.useEffect(()=>{var t;(t=$.current)==null||t.scrollIntoView({behavior:"smooth"})},[x]);const M=()=>{if(!u.trim())return;const t={id:Date.now().toString(),content:u,sender:"user",timestamp:new Date};g(s=>[...s,t]),p(""),v(!0),setTimeout(()=>{N(u)},500)},N=t=>{const s=/\b[A-Z]{2,7}\b/g,a=t.match(s)||[],r=/analysis|analyze|check|what about|how is|tell me about/i.test(t),l=/technical|chart|pattern|trend|support|resistance/i.test(t),n=/fundamental|pe|eps|dividend|revenue|profit|growth/i.test(t),o=/recommend|should i buy|should i sell|good time|entry|exit/i.test(t);let d="",m="";if(a.length>0){const B=["NIFTY","BANKNIFTY","FINNIFTY"],O=["RELIANCE","TCS","HDFCBANK","INFY","ICICIBANK","SBIN"];m=a.find(D=>B.includes(D))||a.find(D=>O.includes(D))||a[0]}m?r?l?d=S(m):n?d=P(m):o?d=T(m):d=k(m):d=k(m):t.toLowerCase().includes("market")?d=I():t.toLowerCase().includes("strategy")?d=y():t.toLowerCase().includes("help")||t.toLowerCase().includes("what can you do")?d=`I can help you with:

• Real-time stock analysis
• Technical and fundamental insights
• Market trends and sentiment
• Trading recommendations
• Risk assessment

Just ask me about any stock (e.g., 'Analyze RELIANCE') or market condition!`:d="I'm not sure what you're asking about. Could you mention a specific stock symbol or ask about the market in general?";const A={id:(Date.now()+1).toString(),content:d,sender:"ai",timestamp:new Date};g(B=>[...B,A]),v(!1),m&&["NIFTY","BANKNIFTY","RELIANCE","TCS","HDFCBANK","INFY","ICICIBANK","SBIN"].includes(m)&&h(m)},b=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),M())},S=t=>{const s=["uptrend","downtrend","sideways","consolidating","breaking out"],a=s[Math.floor(Math.random()*s.length)],r=["double bottom","head and shoulders","cup and handle","triangle","flag","pennant"],l=r[Math.floor(Math.random()*r.length)],n=Math.floor(Math.random()*100),o=Math.random()>.5?"bullish":"bearish",d=Math.floor(Math.random()*1e3)+500,m=d+Math.floor(Math.random()*200)+50;return`## Technical Analysis for ${t}

• **Current Trend**: ${a.charAt(0).toUpperCase()+a.slice(1)}
• **Chart Pattern**: Forming a ${l} pattern
• **Key Indicators**:
  - RSI: ${n} (${n>70?"Overbought":n<30?"Oversold":"Neutral"})
  - MACD: Showing ${o} crossover
  - Volume: ${Math.random()>.5?"Above":"Below"} average

• **Support & Resistance**:
  - Support: ₹${d}
  - Resistance: ₹${m}

The price action suggests ${Math.random()>.5?"strength":"weakness"} in the near term. ${Math.random()>.5?"Watch for a breakout above resistance.":"Monitor for a breakdown below support."}`},P=t=>{const s=(Math.random()*30+10).toFixed(2),a=(Math.random()*50+10).toFixed(2),r=(Math.random()*5).toFixed(2),l=(Math.random()*5e4+1e4).toFixed(0),n=(Math.random()*1e4+1e3).toFixed(0),o=(Math.random()*30-10).toFixed(2);return`## Fundamental Analysis for ${t}

• **Valuation Metrics**:
  - P/E Ratio: ${s}x (${parseFloat(s)>25?"High":parseFloat(s)<15?"Low":"Average"} valuation)
  - EPS: ₹${a}
  - Dividend Yield: ${r}%

• **Financial Performance**:
  - Revenue: ₹${l} Cr
  - Net Profit: ₹${n} Cr
  - YoY Growth: ${o}%

• **Sector Comparison**: ${Math.random()>.5?"Outperforming":"Underperforming"} sector peers
• **Analyst Consensus**: ${["Strong Buy","Buy","Hold","Sell","Strong Sell"][Math.floor(Math.random()*5)]}

${t} shows ${parseFloat(o)>0?"positive growth trends":"challenging growth environment"} with ${parseFloat(s)>25?"premium valuation":parseFloat(s)<15?"attractive valuation":"fair valuation"} compared to industry standards.`},T=t=>{const s=Math.random()>.6?"BUY":Math.random()>.5?"SELL":"HOLD",a=Math.floor(Math.random()*2e3)+500,r=s==="BUY"?a*(1+Math.random()*.2):a*(1-Math.random()*.2),l=s==="BUY"?a*(1-Math.random()*.1):a*(1+Math.random()*.1),n=["short-term","medium-term","long-term"][Math.floor(Math.random()*3)],o=Math.floor(Math.random()*30)+70;return`## Trade Recommendation for ${t}

• **Action**: ${s}
• **Current Price**: ₹${a.toFixed(2)}
• **Target Price**: ₹${r.toFixed(2)} (${s==="BUY"?"+":""}${((r-a)/a*100).toFixed(2)}%)
• **Stop Loss**: ₹${l.toFixed(2)} (${s==="BUY"?"-":"+"}${(Math.abs(l-a)/a*100).toFixed(2)}%)
• **Risk-Reward Ratio**: ${(Math.abs(r-a)/Math.abs(l-a)).toFixed(2)}
• **Timeframe**: ${n.charAt(0).toUpperCase()+n.slice(1)}
• **Confidence**: ${o}%

**Rationale**: ${s==="BUY"?`${t} is showing strength with positive momentum and favorable risk-reward setup.`:s==="SELL"?`${t} is showing weakness with negative momentum and deteriorating technicals.`:`${t} is in a consolidation phase. Better to wait for a clear breakout or breakdown.`}

**Key Levels to Watch**: Support at ₹${(a*.95).toFixed(2)} and resistance at ₹${(a*1.05).toFixed(2)}.`},k=t=>{const s=Math.floor(Math.random()*2e3)+500,a=(Math.random()*5-2.5).toFixed(2),r=(parseFloat(a)/s*100).toFixed(2),l=(Math.random()*10+1).toFixed(2);return`## Market Analysis for ${t}

• **Current Price**: ₹${s.toFixed(2)}
• **Change**: ${parseFloat(a)>=0?"+":""}${a} (${parseFloat(r)>=0?"+":""}${r}%)
• **Volume**: ${l}M shares (${Math.random()>.5?"Above":"Below"} average)
• **Market Sentiment**: ${["Bullish","Bearish","Neutral"][Math.floor(Math.random()*3)]}

${t} is currently ${parseFloat(a)>=0?"trading higher":"trading lower"} with ${Math.random()>.5?"strong":"moderate"} momentum. The overall market context is ${["favorable","challenging","mixed"][Math.floor(Math.random()*3)]}.

Would you like me to provide more detailed technical analysis, fundamental insights, or a specific trade recommendation?`},I=()=>{const t=(Math.random()*2-1).toFixed(2),s=(Math.random()*2.5-1.2).toFixed(2),a=(Math.random()*5+10).toFixed(2);return`## Market Overview

• **NIFTY 50**: ${parseFloat(t)>=0?"+":""}${t}%
• **BANK NIFTY**: ${parseFloat(s)>=0?"+":""}${s}%
• **INDIA VIX**: ${a} (${parseFloat(a)>15?"Elevated":"Low"} volatility)
• **Market Breadth**: ${Math.random()>.5?"Positive":"Negative"} (${Math.floor(Math.random()*500)+1e3} advances, ${Math.floor(Math.random()*500)+800} declines)
• **FII Activity**: ${Math.random()>.5?"Net Buyers":"Net Sellers"}
• **DII Activity**: ${Math.random()>.5?"Net Buyers":"Net Sellers"}

**Top Performing Sectors**:
1. ${["IT","Banking","Pharma","Auto","FMCG"][Math.floor(Math.random()*5)]} (+${(Math.random()*2+.5).toFixed(2)}%)
2. ${["Energy","Metal","Realty","Media","Consumer Durables"][Math.floor(Math.random()*5)]} (+${(Math.random()*1.5+.3).toFixed(2)}%)

**Underperforming Sectors**:
1. ${["Telecom","PSU Banks","Oil & Gas","Power","Capital Goods"][Math.floor(Math.random()*5)]} (${(Math.random()*-2-.5).toFixed(2)}%)

The market is showing ${Math.random()>.5?"strength":"weakness"} with ${Math.random()>.5?"positive":"mixed"} global cues. ${Math.random()>.5?"Traders are advised to maintain a bullish bias.":"Caution is advised in the current market environment."}`},y=()=>{const t=[`## Momentum Trading Strategy

• **Concept**: Capitalize on stocks showing strong price movement and volume
• **Entry Criteria**:
  - Stock up >2% with above-average volume
  - RSI above 60 and rising
  - MACD showing bullish crossover
• **Exit Strategy**:
  - Take profit at 5-8% gain
  - Stop loss at 2-3% below entry
  - Exit if RSI becomes overbought (>80)

This strategy works best in trending markets with clear sector rotation. Focus on stocks breaking out of consolidation patterns with institutional buying.`,`## Breakout Trading Strategy

• **Concept**: Enter trades when price breaks through significant resistance levels
• **Entry Criteria**:
  - Price breaks above key resistance with volume
  - Wait for retest of breakout level
  - Confirm with momentum indicators
• **Exit Strategy**:
  - Target: Distance equal to prior range
  - Stop loss: Below the breakout level

Look for stocks forming clear chart patterns like triangles, flags, or rectangles before the breakout. Higher time frame breakouts tend to be more reliable.`,`## Gap Trading Strategy

• **Concept**: Trade price gaps that occur between market sessions
• **Entry Criteria**:
  - Gap up/down >1.5% from previous close
  - Volume at least 1.5x average
  - First 30 minutes price action confirmation
• **Exit Strategy**:
  - For gap fills: Exit when price reaches previous close
  - For gap continuations: Use trailing stop

Gap trading requires quick decision-making in the first hour of trading. Pre-market analysis and sector correlation assessment are crucial for success.`,`## Mean Reversion Strategy

• **Concept**: Trade the return to average price after extreme moves
• **Entry Criteria**:
  - Stock deviates >2 standard deviations from 20-day MA
  - RSI reaches oversold (<30) or overbought (>70) levels
  - Volume declining after extreme move
• **Exit Strategy**:
  - Take profit at mean (20-day MA)
  - Stop loss if price continues in extreme direction

This strategy performs best in range-bound markets or on stocks with established trading ranges. Avoid using during earnings season or major news events.`];return t[Math.floor(Math.random()*t.length)]},F=t=>(t=t.replace(/^## (.*$)/gm,'<h3 class="text-lg font-semibold text-slate-200 mb-2">$1</h3>'),t=t.replace(/^• (.*$)/gm,'<div class="flex items-start space-x-2 mb-1"><div class="w-1 h-1 bg-green-400 rounded-full mt-2"></div><div>$1</div></div>'),t=t.replace(/^  - (.*$)/gm,'<div class="ml-4 flex items-start space-x-2 mb-1"><div class="w-1 h-1 bg-slate-400 rounded-full mt-2"></div><div>$1</div></div>'),t=t.replace(/^(\d+)\. (.*$)/gm,'<div class="flex items-start space-x-2 mb-1"><div class="text-green-400 font-medium">$1.</div><div>$2</div></div>'),t=t.replace(/\*\*(.*?)\*\*/g,'<span class="font-semibold text-slate-200">$1</span>'),t=t.replace(/\n\n/g,"<br><br>"),t);return e.jsxs("div",{className:"professional-card border border-slate-700/50 flex flex-col h-full",children:[e.jsx("div",{className:"p-3 border-b border-slate-700/50 bg-slate-800/50",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"w-5 h-5 text-green-400"}),e.jsx("h2",{className:"text-base font-semibold text-slate-200 font-mono",children:"AI TRADING ASSISTANT"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 professional-scroll",children:[x.map(t=>e.jsx("div",{className:`flex ${t.sender==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[85%] ${t.sender==="user"?"order-2":"order-1"}`,children:e.jsxs("div",{className:`flex items-start space-x-2 ${t.sender==="user"?"flex-row-reverse space-x-reverse":""}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${t.sender==="user"?"bg-gradient-to-br from-green-600 to-green-500":"bg-gradient-to-br from-green-600 to-teal-600"}`,children:t.sender==="user"?e.jsx(W,{className:"w-4 h-4 text-white"}):e.jsx(R,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:`flex-1 ${t.sender==="user"?"text-right":""}`,children:[e.jsx("div",{className:`inline-block p-3 rounded-lg ${t.sender==="user"?"bg-gradient-to-r from-green-600 to-green-500 text-white":"bg-slate-800/80 border border-slate-700/50 text-slate-200"}`,children:t.sender==="user"?e.jsx("div",{className:"text-sm",children:t.content}):e.jsx("div",{className:"text-sm ai-message",dangerouslySetInnerHTML:{__html:F(t.content)}})}),e.jsx("div",{className:"flex items-center mt-1 text-xs text-slate-500",children:t.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})})},t.id)),f&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"max-w-[85%]",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 bg-gradient-to-br from-green-600 to-teal-600",children:e.jsx(R,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"inline-block p-3 rounded-lg bg-slate-800/80 border border-slate-700/50 text-slate-200",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-slate-600 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-slate-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),e.jsx("div",{className:"w-2 h-2 bg-slate-600 rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})})]})})}),e.jsx("div",{ref:$})]}),e.jsxs("div",{className:"p-3 border-t border-slate-700/50 bg-slate-800/50",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("textarea",{value:u,onChange:t=>p(t.target.value),onKeyPress:b,placeholder:"Ask about any stock or trading strategy...",className:"flex-1 p-2 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-200 placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-green-500/50 focus:border-green-500/50 resize-none font-mono text-sm",rows:1}),e.jsx("button",{onClick:M,disabled:!u.trim()||f,className:"p-2 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-sm hover:from-green-700 hover:to-green-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(_,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500 font-mono",children:`Try: "Analyze RELIANCE" or "What's the market outlook today?"`})]})]})},xe=({symbol:h,currentPrice:x,onClose:g})=>{const[u,p]=i.useState([{id:"1",content:`I'm your AI Chart Assistant for ${h}. Ask me about technical analysis, patterns, or predictions for this chart.`,sender:"ai",timestamp:new Date}]),[f,v]=i.useState(""),[$,M]=i.useState(!1),N=i.useRef(null);i.useEffect(()=>{var s;(s=N.current)==null||s.scrollIntoView({behavior:"smooth"})},[u]),i.useEffect(()=>{p([{id:"1",content:`I'm your AI Chart Assistant for ${h}. Ask me about technical analysis, patterns, or predictions for this chart.`,sender:"ai",timestamp:new Date}])},[h]);const b=()=>{if(!f.trim())return;const s={id:Date.now().toString(),content:f,sender:"user",timestamp:new Date};p(a=>[...a,s]),v(""),M(!0),setTimeout(()=>{S(f)},500)},S=s=>{const a=/technical|chart|pattern|trend|support|resistance/i.test(s),r=/predict|forecast|future|next|target|price target/i.test(s),l=/pattern|formation|setup|candlestick/i.test(s),n=/indicator|rsi|macd|bollinger|moving average|ema|sma/i.test(s);let o="";a?o=T(h,x):r?o=k(h,x):l?o=I(h,x):n?o=y(h,x):o=F(h,x);const d={id:(Date.now()+1).toString(),content:o,sender:"ai",timestamp:new Date};p(m=>[...m,d]),M(!1)},P=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),b())},T=(s,a)=>{const r=a||Math.floor(Math.random()*2e3)+500,l=["uptrend","downtrend","sideways","consolidating","breaking out"],n=l[Math.floor(Math.random()*l.length)],o=["double bottom","head and shoulders","cup and handle","triangle","flag","pennant"],d=o[Math.floor(Math.random()*o.length)],m=Math.floor(r*.95),A=Math.floor(r*1.05);return`## Technical Analysis for ${s}

• **Current Price**: ₹${r.toFixed(2)}
• **Current Trend**: ${n.charAt(0).toUpperCase()+n.slice(1)}
• **Chart Pattern**: Forming a ${d} pattern

• **Key Levels**:
  - Support: ₹${m}
  - Resistance: ₹${A}
  - Pivot: ₹${Math.floor((m+A)/2)}

• **Volume Analysis**: ${Math.random()>.5?"Above average volume indicating strong interest":"Below average volume suggesting consolidation"}

The price action suggests ${Math.random()>.5?"strength":"weakness"} in the near term. ${Math.random()>.5?"Watch for a breakout above resistance.":"Monitor for a breakdown below support."}`},k=(s,a)=>{const r=a||Math.floor(Math.random()*2e3)+500,l=Math.random()*6-3,n=Math.random()*10-3,o=Math.random()*15,d=r*(1+l/100),m=r*(1+n/100),A=r*(1+o/100);return`## Price Prediction for ${s}

• **Current Price**: ₹${r.toFixed(2)}

• **Short-term Outlook** (1-5 days):
  - Target: ₹${d.toFixed(2)} (${l>=0?"+":""}${l.toFixed(2)}%)
  - Confidence: ${Math.floor(Math.random()*20)+60}%

• **Medium-term Outlook** (1-3 weeks):
  - Target: ₹${m.toFixed(2)} (${n>=0?"+":""}${n.toFixed(2)}%)
  - Confidence: ${Math.floor(Math.random()*15)+55}%

• **Long-term Outlook** (1-3 months):
  - Target: ₹${A.toFixed(2)} (${o>=0?"+":""}${o.toFixed(2)}%)
  - Confidence: ${Math.floor(Math.random()*10)+50}%

**Key Drivers**: ${Math.random()>.5?"Technical breakout, positive sector momentum":"Value buying, institutional accumulation"}

**Risk Factors**: Market volatility, sector rotation, and broader market sentiment could impact these projections.`},I=(s,a)=>{const r=a||Math.floor(Math.random()*2e3)+500,l=[{name:"Double Bottom",reliability:"75%",target:r*1.08},{name:"Cup and Handle",reliability:"82%",target:r*1.12},{name:"Bullish Flag",reliability:"68%",target:r*1.06},{name:"Ascending Triangle",reliability:"72%",target:r*1.09},{name:"Head and Shoulders",reliability:"70%",target:r*.92},{name:"Descending Triangle",reliability:"74%",target:r*.91}],n=l[Math.floor(Math.random()*l.length)],o=n.target>r;return`## Chart Pattern Analysis for ${s}

• **Identified Pattern**: ${n.name}
• **Pattern Reliability**: ${n.reliability}
• **Current Price**: ₹${r.toFixed(2)}
• **Pattern Target**: ₹${n.target.toFixed(2)} (${o?"+":""}${((n.target-r)/r*100).toFixed(2)}%)

• **Pattern Characteristics**:
  - ${o?"Bullish":"Bearish"} bias
  - ${Math.random()>.5?"Strong":"Moderate"} volume confirmation
  - ${Math.random()>.5?"Clear":"Developing"} pattern structure

• **Trading Strategy**:
  - Entry: ${o?"On breakout above resistance":"On breakdown below support"}
  - Stop Loss: ₹${o?(r*.97).toFixed(2):(r*1.03).toFixed(2)}
  - Take Profit: ₹${n.target.toFixed(2)}

**Note**: This pattern is ${Math.floor(Math.random()*30)+70}% complete and should resolve within ${Math.floor(Math.random()*5)+3} trading sessions.`},y=(s,a)=>{const r=a||Math.floor(Math.random()*2e3)+500,l=Math.floor(Math.random()*100),n=Math.random()>.5?"bullish crossover":"bearish crossover",o=["upper band","middle band","lower band"][Math.floor(Math.random()*3)],d=r*(1+(Math.random()*6-3)/100),m=r*(1+(Math.random()*10-5)/100);return`## Technical Indicator Analysis for ${s}

• **Current Price**: ₹${r.toFixed(2)}

• **Momentum Indicators**:
  - RSI: ${l} (${l>70?"Overbought":l<30?"Oversold":"Neutral"})
  - MACD: Showing ${n}
  - Stochastic: ${Math.floor(Math.random()*100)}% (${Math.random()>.5?"Bullish":"Bearish"} divergence)

• **Trend Indicators**:
  - 50 EMA: ₹${d.toFixed(2)} (Price is ${r>d?"above":"below"})
  - 200 EMA: ₹${m.toFixed(2)} (Price is ${r>m?"above":"below"})
  - Bollinger Bands: Price at ${o}

• **Volume Indicators**:
  - OBV: ${Math.random()>.5?"Rising":"Falling"}
  - Volume: ${Math.random()>.5?"Above":"Below"} 20-day average

**Indicator Consensus**: ${l>70||l<30||n.includes("bullish")||n.includes("bearish")||o!=="middle band"?`${Math.random()>.5?"Bullish":"Bearish"} with ${Math.floor(Math.random()*20)+60}% confidence`:"Neutral - waiting for clearer signals"}`},F=(s,a)=>{const r=a||Math.floor(Math.random()*2e3)+500;return`## Market Analysis for ${s}

• **Current Price**: ₹${r.toFixed(2)}
• **Market Context**: ${Math.random()>.5?"Bullish":"Bearish"} market environment
• **Sector Performance**: ${Math.random()>.5?"Outperforming":"Underperforming"} its sector

I can provide more specific analysis about ${s}. Would you like to know about:

• Technical analysis and chart patterns
• Price predictions and targets
• Indicator readings (RSI, MACD, etc.)
• Trading strategies for this stock

Just ask me what you'd like to know about ${s}!`},t=s=>(s=s.replace(/^## (.*$)/gm,'<h3 class="text-lg font-semibold text-slate-200 mb-2">$1</h3>'),s=s.replace(/^• (.*$)/gm,'<div class="flex items-start space-x-2 mb-1"><div class="w-1 h-1 bg-green-400 rounded-full mt-2"></div><div>$1</div></div>'),s=s.replace(/^  - (.*$)/gm,'<div class="ml-4 flex items-start space-x-2 mb-1"><div class="w-1 h-1 bg-slate-400 rounded-full mt-2"></div><div>$1</div></div>'),s=s.replace(/\*\*(.*?)\*\*/g,'<span class="font-semibold text-slate-200">$1</span>'),s=s.replace(/\n\n/g,"<br><br>"),s);return e.jsxs("div",{className:"absolute inset-0 z-20 bg-slate-900/95 backdrop-blur-xl border border-slate-700/50 rounded-sm shadow-xl flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-slate-700/50 bg-slate-800/50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"w-5 h-5 text-green-400"}),e.jsxs("h2",{className:"text-base font-semibold text-slate-200 font-mono",children:["AI CHART ASSISTANT • ",h]}),x&&e.jsxs("div",{className:"text-sm text-green-400 font-mono",children:["₹",x.toFixed(2)]})]}),e.jsx("button",{onClick:g,className:"p-1.5 rounded-sm hover:bg-slate-700 transition-colors",children:e.jsx(G,{className:"w-4 h-4 text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 professional-scroll",children:[u.map(s=>e.jsx("div",{className:`flex ${s.sender==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[85%] ${s.sender==="user"?"order-2":"order-1"}`,children:e.jsxs("div",{className:`flex items-start space-x-2 ${s.sender==="user"?"flex-row-reverse space-x-reverse":""}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${s.sender==="user"?"bg-gradient-to-br from-green-600 to-green-500":"bg-gradient-to-br from-green-600 to-teal-600"}`,children:s.sender==="user"?e.jsx(U,{className:"w-4 h-4 text-white"}):e.jsx(R,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:`flex-1 ${s.sender==="user"?"text-right":""}`,children:[e.jsx("div",{className:`inline-block p-3 rounded-lg ${s.sender==="user"?"bg-gradient-to-r from-green-600 to-green-500 text-white":"bg-slate-800/80 border border-slate-700/50 text-slate-200"}`,children:s.sender==="user"?e.jsx("div",{className:"text-sm",children:s.content}):e.jsx("div",{className:"text-sm ai-message",dangerouslySetInnerHTML:{__html:t(s.content)}})}),e.jsx("div",{className:"flex items-center mt-1 text-xs text-slate-500",children:s.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})})},s.id)),$&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"max-w-[85%]",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 bg-gradient-to-br from-green-600 to-teal-600",children:e.jsx(R,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"inline-block p-3 rounded-lg bg-slate-800/80 border border-slate-700/50 text-slate-200",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-slate-600 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-slate-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),e.jsx("div",{className:"w-2 h-2 bg-slate-600 rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})})]})})}),e.jsx("div",{ref:N})]}),e.jsx("div",{className:"p-2 border-t border-slate-700/50 bg-slate-800/30",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:[{text:"Analyze trend",icon:e.jsx(U,{className:"w-3 h-3"})},{text:"Price prediction",icon:e.jsx(Q,{className:"w-3 h-3"})},{text:"Chart patterns",icon:e.jsx(L,{className:"w-3 h-3"})},{text:"Technical indicators",icon:e.jsx(X,{className:"w-3 h-3"})},{text:"Support/Resistance",icon:e.jsx(Z,{className:"w-3 h-3"})},{text:"Trading strategy",icon:e.jsx(K,{className:"w-3 h-3"})}].map((s,a)=>e.jsxs("button",{onClick:()=>{v(s.text),setTimeout(()=>b(),100)},className:"flex items-center space-x-1 px-2 py-1 bg-slate-800/60 border border-slate-600/50 rounded-sm hover:bg-slate-700/60 transition-colors text-xs text-slate-300",children:[s.icon,e.jsx("span",{children:s.text})]},a))})}),e.jsx("div",{className:"p-3 border-t border-slate-700/50 bg-slate-800/50",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("textarea",{value:f,onChange:s=>v(s.target.value),onKeyPress:P,placeholder:`Ask about ${h} chart analysis...`,className:"flex-1 p-2 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-200 placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-green-500/50 focus:border-green-500/50 resize-none font-mono text-sm",rows:1}),e.jsx("button",{onClick:b,disabled:!f.trim()||$,className:"p-2 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-sm hover:from-green-700 hover:to-green-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(_,{className:"w-5 h-5"})})]})})]})},ue=({symbol:h})=>{var d,m,A,B,O,D,H,q;const x=ee(),[g,u]=i.useState(!1),[p,f]=i.useState(!1),[v,$]=i.useState([]),[M,N]=i.useState([]),[b,S]=i.useState(null),[P,T]=i.useState(new Date),[k,I]=i.useState(null),[y,F]=i.useState("positions");i.useEffect(()=>{(async()=>{const C=localStorage.getItem("dhanCredentials");if(C)try{const j=JSON.parse(C);E.initialize(j);const w=await E.authenticate();u(w),w&&(t(),s("dhan",j.clientId,"connected"))}catch(j){console.error("Error checking broker connection:",j),u(!1),I("Failed to connect to broker. Please reconnect.")}else u(!1)})()},[]);const t=async()=>{f(!0),I(null);try{const[c,C,j]=await Promise.all([E.getHoldings(),E.getPositions(),E.getFunds()]);$(c),N(C),S(j),T(new Date)}catch(c){console.error("Error fetching broker data:",c),I("Failed to fetch broker data. Please try again.")}finally{f(!1)}},s=async(c,C,j)=>{try{const w=localStorage.getItem("traderdesk_user");if(!w){console.warn("No current user found, skipping connection log");return}const J=JSON.parse(w);ne.saveBrokerConnection({user_id:J.id,broker:c,client_id:C,status:j,last_connected_at:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}catch(w){console.error("Error logging connection:",w)}},a=async()=>{await t()},r=()=>M.find(c=>c.symbol===h),l=()=>v.find(c=>c.symbol===h),n=r(),o=l();return e.jsx(oe,{children:e.jsxs("div",{className:"professional-card border border-slate-700/50 flex flex-col h-full",children:[e.jsxs("div",{className:"p-3 border-b border-slate-700/50 bg-slate-800/50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5 text-green-400"}),e.jsx("h2",{className:"text-base font-semibold text-slate-200 font-mono",children:"BROKER PANEL"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[g?e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-green-400 bg-green-900/30 px-2 py-1 rounded-sm font-mono border border-green-700/50",children:[e.jsx(ie,{className:"w-3 h-3"}),e.jsx("span",{children:"CONNECTED"})]}):e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-red-400 bg-red-900/30 px-2 py-1 rounded-sm font-mono border border-red-700/50",children:[e.jsx(V,{className:"w-3 h-3"}),e.jsx("span",{children:"DISCONNECTED"})]}),e.jsx("button",{onClick:a,disabled:p||!g,className:"p-1.5 rounded-sm hover:bg-slate-800 transition-colors disabled:opacity-50",children:e.jsx(le,{className:`w-3.5 h-3.5 text-slate-300 ${p?"animate-spin":""}`})})]})]}),g?k?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4",children:[e.jsx(V,{className:"w-12 h-12 text-red-500 mb-3"}),e.jsx("p",{className:"text-red-400 text-center mb-4",children:k}),e.jsx("button",{onClick:a,disabled:p,className:"px-4 py-2 bg-slate-800/60 border border-slate-600/50 text-slate-300 rounded-sm hover:bg-slate-700/60 transition-colors text-sm",children:p?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-4 h-4 animate-spin mr-2"}),e.jsx("span",{children:"Refreshing..."})]}):"Try Again"})]}):p?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4",children:[e.jsx(Y,{className:"w-12 h-12 text-green-400 animate-spin mb-3"}),e.jsx("p",{className:"text-slate-400 text-center",children:"Loading broker data..."})]}):e.jsxs("div",{className:"flex-1 flex flex-col",children:[b&&e.jsxs("div",{className:"p-3 border-b border-slate-700/50 bg-slate-800/20",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(de,{className:"w-4 h-4 text-green-400"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-200 font-mono",children:"FUNDS"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs font-mono",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Available:"}),e.jsxs("div",{className:"font-medium text-green-400",children:["₹",((d=b.availableBalance)==null?void 0:d.toLocaleString())||"0.00"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Used Margin:"}),e.jsxs("div",{className:"font-medium text-slate-300",children:["₹",((m=b.usedMargin)==null?void 0:m.toLocaleString())||"0.00"]})]})]})]}),(n||o)&&e.jsxs("div",{className:"p-3 border-b border-slate-700/50 bg-green-900/10",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(L,{className:"w-4 h-4 text-green-400"}),e.jsxs("h3",{className:"text-sm font-semibold text-slate-200 font-mono",children:[h," POSITION"]})]}),n&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs font-mono",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Quantity:"}),e.jsx("div",{className:"font-medium text-slate-300",children:n.quantity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Avg. Price:"}),e.jsxs("div",{className:"font-medium text-slate-300",children:["₹",((A=n.averagePrice)==null?void 0:A.toFixed(2))||"0.00"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"P&L:"}),e.jsxs("div",{className:`font-medium ${n.pnl>=0?"text-green-400":"text-red-400"}`,children:["₹",((B=n.pnl)==null?void 0:B.toFixed(2))||"0.00"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"P&L %:"}),e.jsxs("div",{className:`font-medium ${n.pnlPercentage>=0?"text-green-400":"text-red-400"}`,children:[n.pnlPercentage>=0?"+":"",((O=n.pnlPercentage)==null?void 0:O.toFixed(2))||"0.00","%"]})]})]}),!n&&o&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs font-mono",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Quantity:"}),e.jsx("div",{className:"font-medium text-slate-300",children:o.quantity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Avg. Price:"}),e.jsxs("div",{className:"font-medium text-slate-300",children:["₹",((D=o.averagePrice)==null?void 0:D.toFixed(2))||"0.00"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"P&L:"}),e.jsxs("div",{className:`font-medium ${o.pnl>=0?"text-green-400":"text-red-400"}`,children:["₹",((H=o.pnl)==null?void 0:H.toFixed(2))||"0.00"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"P&L %:"}),e.jsxs("div",{className:`font-medium ${o.pnlPercentage>=0?"text-green-400":"text-red-400"}`,children:[o.pnlPercentage>=0?"+":"",((q=o.pnlPercentage)==null?void 0:q.toFixed(2))||"0.00","%"]})]})]})]}),e.jsxs("div",{className:"flex border-b border-slate-700/50",children:[e.jsx("button",{onClick:()=>F("positions"),className:`flex-1 py-2 text-xs font-mono ${y==="positions"?"text-green-400 border-b-2 border-green-400":"text-slate-400 hover:text-slate-300"}`,children:"POSITIONS"}),e.jsx("button",{onClick:()=>F("holdings"),className:`flex-1 py-2 text-xs font-mono ${y==="holdings"?"text-green-400 border-b-2 border-green-400":"text-slate-400 hover:text-slate-300"}`,children:"HOLDINGS"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto professional-scroll",children:[y==="positions"&&e.jsx("div",{className:"p-2",children:M.length>0?e.jsx("div",{className:"space-y-2",children:M.map((c,C)=>{var j,w;return e.jsxs("div",{className:"p-2 bg-slate-800/30 rounded-sm border border-slate-700/30 hover:border-slate-600/50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("div",{className:"text-xs font-medium text-slate-200 font-mono",children:c.symbol}),e.jsxs("div",{className:`text-xs font-medium ${c.pnl>=0?"text-green-400":"text-red-400"} font-mono`,children:[c.pnl>=0?"+":"","₹",((j=c.pnl)==null?void 0:j.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 font-mono",children:[e.jsxs("span",{children:["Qty: ",c.quantity]}),e.jsxs("span",{children:[c.pnlPercentage>=0?"+":"",((w=c.pnlPercentage)==null?void 0:w.toFixed(2))||"0.00","%"]})]})]},C)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4",children:[e.jsx(L,{className:"w-8 h-8 text-slate-600 mb-2"}),e.jsx("p",{className:"text-slate-400 text-sm text-center",children:"No open positions"})]})}),y==="holdings"&&e.jsx("div",{className:"p-2",children:v.length>0?e.jsx("div",{className:"space-y-2",children:v.map((c,C)=>{var j,w;return e.jsxs("div",{className:"p-2 bg-slate-800/30 rounded-sm border border-slate-700/30 hover:border-slate-600/50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("div",{className:"text-xs font-medium text-slate-200 font-mono",children:c.symbol}),e.jsxs("div",{className:`text-xs font-medium ${c.pnl>=0?"text-green-400":"text-red-400"} font-mono`,children:[c.pnl>=0?"+":"","₹",((j=c.pnl)==null?void 0:j.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 font-mono",children:[e.jsxs("span",{children:["Qty: ",c.quantity]}),e.jsxs("span",{children:[c.pnlPercentage>=0?"+":"",((w=c.pnlPercentage)==null?void 0:w.toFixed(2))||"0.00","%"]})]})]},C)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4",children:[e.jsx(L,{className:"w-8 h-8 text-slate-600 mb-2"}),e.jsx("p",{className:"text-slate-400 text-sm text-center",children:"No holdings found"})]})})]}),e.jsxs("div",{className:"p-2 border-t border-slate-700/50 bg-slate-800/20 text-xs text-slate-500 font-mono flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(K,{className:"w-3 h-3"}),e.jsxs("span",{children:["Last updated: ",P.toLocaleTimeString()]})]}),e.jsx("button",{onClick:a,disabled:p,className:"text-green-400 hover:text-green-300 disabled:text-slate-500 disabled:cursor-not-allowed",children:"Refresh"})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4",children:[e.jsx(te,{className:"w-12 h-12 text-slate-600 mb-3"}),e.jsx("p",{className:"text-slate-400 text-center mb-4",children:"Connect your broker to view positions and place orders"}),e.jsx("button",{onClick:()=>x("/broker"),className:"px-4 py-2 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-sm hover:from-green-700 hover:to-green-600 transition-all duration-200 text-sm",children:"Connect Broker"})]})]})})},Se=()=>{const{user:h}=se(),[x,g]=i.useState("NIFTY"),[u,p]=i.useState(!1),[f,v]=i.useState(!1),[$,M]=i.useState(!0);i.useEffect(()=>{const b=localStorage.getItem("dhanCredentials");if(b)try{const S=JSON.parse(b);E.initialize(S),E.authenticate()}catch(S){console.error("Error parsing Dhan credentials:",S),localStorage.removeItem("dhanCredentials")}},[]);const N=b=>{g(b)};return e.jsx(ae,{isPaidUser:(h==null?void 0:h.isPaidUser)||!1,featureName:"Trading Desk",children:e.jsxs("div",{className:"flex h-screen bg-slate-900 text-white",children:[e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-800 border-b border-slate-700",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(me,{onSymbolSelect:N,selectedSymbol:x}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{className:"text-lg font-semibold",children:x})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>p(!u),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700",children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("span",{children:"AI Assistant"})]}),e.jsxs("button",{onClick:()=>v(!f),className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 rounded-lg hover:bg-purple-700",children:[e.jsx(ce,{className:"w-5 h-5"}),e.jsx("span",{children:"Chart AI"})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-1 p-4 flex items-center justify-center",children:e.jsx("span",{className:"text-slate-400",children:"Chart will appear here."})}),e.jsx("div",{className:"h-1/3 bg-slate-800 border-t border-slate-700 overflow-auto flex items-center justify-center",children:e.jsx("span",{className:"text-slate-500",children:"Option chain will appear here."})})]})]}),$&&e.jsx("div",{className:"w-80 bg-slate-800 border-l border-slate-700 overflow-y-auto",children:e.jsx(ue,{symbol:x})}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(he,{onSymbolSelect:N})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(xe,{symbol:x,onClose:()=>v(!1)})})]})})};export{Se as default};
