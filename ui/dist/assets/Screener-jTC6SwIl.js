import{c as u,j as e,f as R,r,g as b,h as p,T as M,Z as B,F as O}from"./index-CJAOEYsQ.js";import{P as U}from"./PaidUserGuard-BF9fc_-7.js";import{D as H}from"./DataService-KI_3QH8v.js";import{E as V}from"./ErrorBoundary-BV10QnMf.js";import"./dhanApiService-CQPu0InZ.js";import"./refresh-cw-Uhijyyid.js";const q=u("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]),K=u("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Y=({items:x,lastUpdated:l})=>e.jsx("div",{className:"professional-card p-3 border border-slate-700/50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm font-mono",children:[e.jsx("div",{className:"flex items-center space-x-6 overflow-x-auto professional-scroll",children:x.map((n,c)=>e.jsxs("div",{className:"flex items-center space-x-2 whitespace-nowrap",children:[n.isAnimated&&e.jsx("div",{className:`w-2 h-2 ${n.color||"bg-green-400"} rounded-full animate-pulse`}),n.icon,e.jsxs("span",{className:"text-slate-400",children:[n.label,": "]}),e.jsx("span",{className:n.color||"text-green-400",children:n.value})]},c))}),l&&e.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[e.jsx("span",{className:"text-slate-400",children:"Last Update: "}),e.jsx("span",{className:"text-green-400",children:l.toLocaleTimeString()})]})]})}),k=()=>{const{user:x}=R(),[l,n]=r.useState(()=>localStorage.getItem("screener_activeTab")||"longterm"),[c,g]=r.useState(!1),[j,y]=r.useState([]),[Z,S]=r.useState([]),[f,w]=r.useState(new Date),[o,h]=r.useState(null),v=H.getInstance(),P=[{id:"longterm",label:"Long Term",icon:M},{id:"ipo",label:"IPO",icon:B},{id:"fno",label:"F&O",icon:q},{id:"shortterm",label:"Short Term",icon:O}];r.useEffect(()=>{localStorage.setItem("screener_activeTab",l)},[l]),r.useEffect(()=>{d();const s=setInterval(()=>{d()},5*60*1e3),a=()=>{document.visibilityState==="visible"&&d()};return document.addEventListener("visibilitychange",a),()=>{clearInterval(s),document.removeEventListener("visibilitychange",a)}},[]);const d=async()=>{g(!0),h(null);try{const[s,a]=await Promise.all([v.getTopGainers(10),v.getTopLosers(10)]),i=s.map(t=>({symbol:t.symbol,name:t.name,price:t.price,change:t.change,changePercent:t.changePercent,marketCap:t.marketCap?`${(t.marketCap/1e5).toFixed(1)}L Cr`:void 0,pe:t.pe||t.peRatio,score:Math.floor(Math.random()*30+70),recommendation:"Strong Buy",volume:`${(Math.random()*5+1).toFixed(1)}x`,rsi:Math.random()*20+70})),$=a.map(t=>({symbol:t.symbol,name:t.name,price:t.price,change:t.change,changePercent:t.changePercent,marketCap:t.marketCap?`${(t.marketCap/1e5).toFixed(1)}L Cr`:void 0,pe:t.pe||t.peRatio,score:Math.floor(Math.random()*30+40),recommendation:"Hold",volume:`${(Math.random()*5+1).toFixed(1)}x`,rsi:Math.random()*20+30}));y(i),S($),w(new Date)}catch(s){console.error("Error fetching stock data:",s),h("Failed to fetch stock data. Please try again.")}finally{g(!1)}},I=j.slice(0,4).map(s=>({...s,recommendation:"Strong Buy"})),C=[{symbol:"IDEAFORGE",name:"ideaForge Technology Ltd",price:685.4,change:45.2,changePercent:7.06,listingGains:12.5,score:72,status:"Recently Listed"},{symbol:"GODIGIT",name:"Go Digit General Insurance",price:312.8,change:-8.75,changePercent:-2.72,listingGains:-5.2,score:68,status:"New Listing"}],T=[{symbol:"NIFTY",name:"Nifty 50 Index",price:19745.3,change:165.85,changePercent:.86,oi:"2.5Cr",pcr:.85,maxPain:19700,score:88},{symbol:"BANKNIFTY",name:"Bank Nifty Index",price:44235.8,change:285.45,changePercent:.65,oi:"1.8Cr",pcr:.92,maxPain:44200,score:81}],L=j.slice(0,2).map(s=>({...s,signal:"Momentum Buy"})),m=s=>s>=80?"bg-green-900/30 text-green-400 border-green-700/50":s>=70?"bg-yellow-900/30 text-yellow-400 border-yellow-700/50":"bg-red-900/30 text-red-400 border-red-700/50",N=()=>e.jsx("div",{className:"space-y-3",children:c?e.jsxs("div",{className:"flex items-center justify-center h-32",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-400"}),e.jsx("span",{className:"ml-3 text-slate-400 font-mono",children:"LOADING DATA..."})]}):o?e.jsxs("div",{className:"flex items-center justify-center h-32 flex-col",children:[e.jsx(p,{className:"w-8 h-8 text-red-400 mb-2"}),e.jsx("p",{className:"text-slate-400 font-mono text-center",children:o}),e.jsx("button",{onClick:d,className:"mt-4 px-3 py-1 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-300 hover:bg-slate-700/60 text-xs",children:"Try Again"})]}):I.map((s,a)=>{var i;return e.jsxs("div",{className:"professional-card p-4 hover:shadow-lg transition-all duration-200 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-200 font-mono",children:s.symbol}),e.jsx("p",{className:"text-sm text-slate-400 font-mono",children:s.name})]})}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-slate-200 font-mono",children:["₹",s.price.toFixed(2)]}),e.jsxs("div",{className:`text-sm font-medium font-mono ${s.change>=0?"text-green-400":"text-red-400"}`,children:[s.change>=0?"+":"",s.change," (",s.changePercent>=0?"+":"",s.changePercent,"%)"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm font-mono",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Market Cap"}),e.jsx("div",{className:"font-semibold text-slate-300",children:s.marketCap})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"P/E Ratio"}),e.jsx("div",{className:"font-semibold text-slate-300",children:(i=s.pe)==null?void 0:i.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Score"}),e.jsxs("div",{className:`inline-block px-2 py-1 rounded-sm text-xs font-semibold border ${m(s.score||0)}`,children:[s.score,"/100"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Recommendation"}),e.jsx("div",{className:"font-semibold text-green-400",children:s.recommendation})]})]})]},a)})}),E=()=>e.jsx("div",{className:"space-y-3",children:C.map((s,a)=>e.jsxs("div",{className:"professional-card p-4 hover:shadow-lg transition-all duration-200 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-200 font-mono",children:s.symbol}),e.jsx("p",{className:"text-sm text-slate-400 font-mono",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-slate-200 font-mono",children:["₹",s.price]}),e.jsxs("div",{className:`text-sm font-medium font-mono ${s.change>=0?"text-green-400":"text-red-400"}`,children:[s.change>=0?"+":"",s.change," (",s.changePercent>=0?"+":"",s.changePercent,"%)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm font-mono",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Listing Gains"}),e.jsxs("div",{className:`font-semibold ${s.listingGains>=0?"text-green-400":"text-red-400"}`,children:[s.listingGains>=0?"+":"",s.listingGains,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Score"}),e.jsxs("div",{className:`inline-block px-2 py-1 rounded-sm text-xs font-semibold border ${m(s.score)}`,children:[s.score,"/100"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-semibold text-green-400",children:s.status})]})]})]},a))}),A=()=>e.jsx("div",{className:"space-y-3",children:T.map((s,a)=>e.jsxs("div",{className:"professional-card p-4 hover:shadow-lg transition-all duration-200 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-200 font-mono",children:s.symbol}),e.jsx("p",{className:"text-sm text-slate-400 font-mono",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-slate-200 font-mono",children:s.price}),e.jsxs("div",{className:`text-sm font-medium font-mono ${s.change>=0?"text-green-400":"text-red-400"}`,children:[s.change>=0?"+":"",s.change," (",s.changePercent>=0?"+":"",s.changePercent,"%)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm font-mono",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Open Interest"}),e.jsx("div",{className:"font-semibold text-slate-300",children:s.oi})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"PCR"}),e.jsx("div",{className:"font-semibold text-slate-300",children:s.pcr})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Max Pain"}),e.jsx("div",{className:"font-semibold text-slate-300",children:s.maxPain})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Score"}),e.jsxs("div",{className:`inline-block px-2 py-1 rounded-sm text-xs font-semibold border ${m(s.score)}`,children:[s.score,"/100"]})]})]})]},a))}),F=()=>e.jsx("div",{className:"space-y-3",children:c?e.jsxs("div",{className:"flex items-center justify-center h-32",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-400"}),e.jsx("span",{className:"ml-3 text-slate-400 font-mono",children:"LOADING DATA..."})]}):o?e.jsxs("div",{className:"flex items-center justify-center h-32 flex-col",children:[e.jsx(p,{className:"w-8 h-8 text-red-400 mb-2"}),e.jsx("p",{className:"text-slate-400 font-mono text-center",children:o}),e.jsx("button",{onClick:d,className:"mt-4 px-3 py-1 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-300 hover:bg-slate-700/60 text-xs",children:"Try Again"})]}):L.map((s,a)=>{var i;return e.jsxs("div",{className:"professional-card p-4 hover:shadow-lg transition-all duration-200 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-200 font-mono",children:s.symbol}),e.jsx("p",{className:"text-sm text-slate-400 font-mono",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-slate-200 font-mono",children:["₹",s.price.toFixed(2)]}),e.jsxs("div",{className:`text-sm font-medium font-mono ${s.change>=0?"text-green-400":"text-red-400"}`,children:[s.change>=0?"+":"",s.change," (",s.changePercent>=0?"+":"",s.changePercent,"%)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm font-mono",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Volume"}),e.jsx("div",{className:"font-semibold text-slate-300",children:s.volume})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"RSI"}),e.jsx("div",{className:"font-semibold text-slate-300",children:(i=s.rsi)==null?void 0:i.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Signal"}),e.jsx("div",{className:"font-semibold text-green-400",children:s.signal})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Score"}),e.jsxs("div",{className:`inline-block px-2 py-1 rounded-sm text-xs font-semibold border ${m(s.score||0)}`,children:[s.score,"/100"]})]})]})]},a)})}),G=()=>{switch(l){case"longterm":return N();case"ipo":return E();case"fno":return A();case"shortterm":return F();default:return N()}},D=[{label:"Screener",value:"ACTIVE",color:"text-green-400",icon:e.jsx(b,{className:"w-3 h-3"}),isAnimated:!0},{label:"Stocks Scanned",value:"2,847",color:"text-green-400"},{label:"Last Scan",value:f.toLocaleTimeString(),color:"text-green-400"}];return e.jsx(U,{isPaidUser:(x==null?void 0:x.isPaidUser)||!1,featureName:"Stock Screener",children:e.jsxs("div",{className:"p-4 md:p-6 h-full flex flex-col space-y-4",children:[o&&e.jsx("div",{className:"professional-card p-4 border border-red-700/50 bg-red-900/20",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(p,{className:"w-5 h-5 text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400",children:o}),e.jsx("button",{onClick:()=>h(null),className:"text-red-400 hover:text-red-300 text-sm mt-2",children:"Dismiss"})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-200 font-mono",children:"MARKET SCREENER"}),e.jsx("p",{className:"text-slate-400 text-sm font-mono",children:"Institutional-grade stock analysis platform"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 bg-green-900/30 border border-green-700/50 rounded-sm",children:[e.jsx(b,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-sm font-mono text-green-300",children:"SCANNING"})]}),e.jsxs("button",{onClick:d,disabled:c,className:"flex items-center space-x-2 px-3 py-2 bg-slate-800/60 border border-slate-600/50 rounded-sm hover:bg-slate-700/60 transition-all duration-200 text-sm",children:[e.jsx(K,{className:`w-4 h-4 text-green-400 ${c?"animate-spin":""}`}),e.jsx("span",{className:"text-slate-300 font-mono",children:"REFRESH"})]})]})]}),e.jsx("div",{className:"professional-card p-2 border border-slate-700/50",children:e.jsx("div",{className:"flex space-x-1",children:P.map(s=>{const a=s.icon;return e.jsxs("button",{onClick:()=>n(s.id),className:`flex items-center space-x-2 px-4 py-3 rounded-sm font-medium transition-all duration-200 text-sm font-mono ${l===s.id?"bg-gradient-to-r from-green-600/20 to-green-500/20 text-green-300 border border-green-600/30":"text-slate-400 hover:text-green-300 hover:bg-slate-800/50"}`,children:[e.jsx(a,{className:"w-4 h-4"}),e.jsx("span",{children:s.label.toUpperCase()})]},s.id)})})}),e.jsx("div",{className:"flex-1 overflow-y-auto professional-scroll",children:e.jsx(V,{children:G()})}),e.jsx(Y,{items:D,lastUpdated:f})]})})};export{k as default};
