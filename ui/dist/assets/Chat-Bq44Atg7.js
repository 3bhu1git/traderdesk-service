import{f as $,u as k,r,j as e,U as c,s as T,t as E}from"./index-CJAOEYsQ.js";import{S as O}from"./search-D7lMVmtB.js";import{U as m}from"./users-DnqjlFb6.js";import{P as R}from"./phone-Buo3OCKm.js";import{C as L}from"./clock-99ryEmKF.js";import{S as P}from"./send-cxHe-UFn.js";const B=()=>{const{user:t}=$(),{users:v,admin:w}=k(),[a,p]=r.useState(null),[u,x]=r.useState([]),[d,b]=r.useState(""),[f,y]=r.useState(""),j=r.useRef(null),h=[...w?[{id:"admin",name:"Admin Support",email:"admin@traderdesk.ai",isOnline:!0,lastSeen:new Date,isAdmin:!0}]:[],...v.map(s=>({id:s.id,name:s.name,email:s.email,phone:s.phone,isOnline:Math.random()>.5,lastSeen:new Date(Date.now()-Math.random()*24*60*60*1e3),isAdmin:!1}))],I=[{id:"1",senderId:"admin",senderName:"Admin Support",receiverId:(t==null?void 0:t.id)||"",receiverName:(t==null?void 0:t.name)||"",content:"Welcome to TraderDesk.ai! How can I help you today?",timestamp:new Date(Date.now()-60*60*1e3),isRead:!0,type:"admin"},{id:"2",senderId:(t==null?void 0:t.id)||"",senderName:(t==null?void 0:t.name)||"",receiverId:"admin",receiverName:"Admin Support",content:"Hi, I have a question about the premium features.",timestamp:new Date(Date.now()-30*60*1e3),isRead:!0,type:"user"},{id:"3",senderId:"admin",senderName:"Admin Support",receiverId:(t==null?void 0:t.id)||"",receiverName:(t==null?void 0:t.name)||"",content:"Sure! I'd be happy to help you with premium features. What specific feature are you interested in?",timestamp:new Date(Date.now()-25*60*1e3),isRead:!0,type:"admin"}];r.useEffect(()=>{if(x(I),h.length>0){const s=h.find(n=>n.isAdmin);s&&p(s)}},[]);const S=()=>{var s;(s=j.current)==null||s.scrollIntoView({behavior:"smooth"})};r.useEffect(()=>{S()},[u]);const A=h.filter(s=>s.name.toLowerCase().includes(f.toLowerCase())||s.email.toLowerCase().includes(f.toLowerCase())),g=s=>u.filter(n=>n.senderId===(t==null?void 0:t.id)&&n.receiverId===s||n.senderId===s&&n.receiverId===(t==null?void 0:t.id)).sort((n,i)=>n.timestamp.getTime()-i.timestamp.getTime()),N=()=>{if(!d.trim()||!a||!t)return;const s={id:Date.now().toString(),senderId:t.id,senderName:t.name,receiverId:a.id,receiverName:a.name,content:d,timestamp:new Date,isRead:!1,type:"user"};x(n=>[...n,s]),b(""),setTimeout(()=>{const n={id:(Date.now()+1).toString(),senderId:a.id,senderName:a.name,receiverId:t.id,receiverName:t.name,content:a.isAdmin?"Thank you for your message. I'll get back to you shortly with the information you need.":"Thanks for reaching out! I'll respond as soon as I can.",timestamp:new Date,isRead:!1,type:a.isAdmin?"admin":"user"};x(i=>[...i,n])},2e3)},M=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),N())},C=s=>{const i=new Date().getTime()-s.getTime(),o=Math.floor(i/6e4),l=Math.floor(i/36e5),D=Math.floor(i/864e5);return o<1?"Just now":o<60?`${o}m ago`:l<24?`${l}h ago`:`${D}d ago`};return e.jsxs("div",{className:"h-full flex bg-slate-950",children:[e.jsxs("div",{className:"w-80 border-r border-slate-700/50 bg-slate-900/50 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700/50",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-200 font-mono mb-3",children:"MESSAGES"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:f,onChange:s=>y(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-200 placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-cyan-500/50 focus:border-cyan-500/50 text-sm font-mono"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto professional-scroll",children:A.map(s=>{const n=g(s.id),i=n[n.length-1],o=n.filter(l=>!l.isRead&&l.senderId===s.id).length;return e.jsx("div",{onClick:()=>p(s),className:`p-4 border-b border-slate-800/50 cursor-pointer transition-all duration-200 hover:bg-slate-800/30 ${(a==null?void 0:a.id)===s.id?"bg-slate-800/50 border-l-2 border-l-cyan-500":""}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${s.isAdmin?"bg-gradient-to-br from-orange-600 to-red-600":"bg-gradient-to-br from-purple-600 to-indigo-600"}`,children:s.isAdmin?e.jsx(m,{className:"w-5 h-5 text-white"}):e.jsx(c,{className:"w-5 h-5 text-white"})}),s.isOnline&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-400 border-2 border-slate-900 rounded-full"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-200 truncate font-mono",children:[s.name,s.isAdmin&&e.jsx("span",{className:"text-orange-400 ml-1",children:"(Admin)"})]}),o>0&&e.jsx("span",{className:"bg-cyan-500 text-white text-xs rounded-full px-2 py-1 font-mono",children:o})]}),e.jsx("div",{className:"flex items-center space-x-2 mt-1",children:e.jsx("span",{className:"text-xs text-slate-400 font-mono",children:s.isOnline?"Online":C(s.lastSeen)})}),i&&e.jsx("p",{className:"text-xs text-slate-500 truncate mt-1 font-mono",children:i.content})]})]})},s.id)})})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 border-b border-slate-700/50 bg-slate-900/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${a.isAdmin?"bg-gradient-to-br from-orange-600 to-red-600":"bg-gradient-to-br from-purple-600 to-indigo-600"}`,children:a.isAdmin?e.jsx(m,{className:"w-5 h-5 text-white"}):e.jsx(c,{className:"w-5 h-5 text-white"})}),a.isOnline&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-400 border-2 border-slate-900 rounded-full"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-200 font-mono",children:[a.name,a.isAdmin&&e.jsx("span",{className:"text-orange-400 ml-1",children:"(Admin)"})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-slate-400 font-mono",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(T,{className:"w-3 h-3"}),e.jsx("span",{children:a.email})]}),a.phone&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(R,{className:"w-3 h-3"}),e.jsx("span",{children:a.phone})]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("div",{className:`px-3 py-1 rounded-sm text-xs font-mono ${a.isOnline?"bg-green-900/30 text-green-400 border border-green-700/50":"bg-slate-800/50 text-slate-400 border border-slate-700/50"}`,children:a.isOnline?"ONLINE":"OFFLINE"})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 professional-scroll",children:[g(a.id).map(s=>e.jsx("div",{className:`flex ${s.senderId===(t==null?void 0:t.id)?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[70%] ${s.senderId===(t==null?void 0:t.id)?"order-2":"order-1"}`,children:e.jsxs("div",{className:`flex items-start space-x-3 ${s.senderId===(t==null?void 0:t.id)?"flex-row-reverse space-x-reverse":""}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${s.senderId===(t==null?void 0:t.id)?"bg-gradient-to-br from-purple-600 to-indigo-600":s.type==="admin"?"bg-gradient-to-br from-orange-600 to-red-600":"bg-gradient-to-br from-cyan-600 to-blue-600"}`,children:s.senderId===(t==null?void 0:t.id)?e.jsx(c,{className:"w-4 h-4 text-white"}):s.type==="admin"?e.jsx(m,{className:"w-4 h-4 text-white"}):e.jsx(c,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:`flex-1 ${s.senderId===(t==null?void 0:t.id)?"text-right":""}`,children:[e.jsx("div",{className:`inline-block p-3 rounded-lg ${s.senderId===(t==null?void 0:t.id)?"bg-gradient-to-r from-purple-600 to-indigo-600 text-white":"bg-slate-800/50 border border-slate-700/50 text-slate-200"}`,children:e.jsx("div",{className:"text-sm font-mono",children:s.content})}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:"text-xs text-slate-500 font-mono",children:s.timestamp.toLocaleTimeString()}),s.senderId===(t==null?void 0:t.id)&&e.jsx("div",{className:"flex items-center",children:s.isRead?e.jsx(E,{className:"w-3 h-3 text-green-400"}):e.jsx(L,{className:"w-3 h-3 text-slate-400"})})]})]})]})})},s.id)),e.jsx("div",{ref:j})]}),e.jsx("div",{className:"p-4 border-t border-slate-700/50 bg-slate-900/50",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("textarea",{value:d,onChange:s=>b(s.target.value),onKeyPress:M,placeholder:`Message ${a.name}...`,className:"w-full p-3 bg-slate-800/60 border border-slate-600/50 rounded-sm text-slate-200 placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-cyan-500/50 focus:border-cyan-500/50 resize-none font-mono text-sm",rows:1})}),e.jsx("button",{onClick:N,disabled:!d.trim(),className:"p-3 bg-gradient-to-r from-cyan-600 to-blue-600 text-white rounded-sm hover:from-cyan-700 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(P,{className:"w-4 h-4"})})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(m,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-400 font-mono",children:"Select a conversation"}),e.jsx("p",{className:"text-slate-500 font-mono",children:"Choose a user to start messaging"})]})})})]})};export{B as default};
